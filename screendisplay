#include <Wire.h>
#include <Adafruit_GFX.h>
#include <Adafruit_SSD1306.h>


#define SCREEN_WIDTH 128
#define SCREEN_HEIGHT 32
#define OLED_RESET -1
#define OLED_ADDR 0x3C


Adafruit_SSD1306 display(SCREEN_WIDTH, SCREEN_HEIGHT, &Wire, OLED_RESET);


const int sensor_pin = A1;   // Soil moisture sensor
const int THRESHOLD = 450;   // Adjust if needed


void setup() {
  Serial.begin(9600);


  if (!display.begin(SSD1306_SWITCHCAPVCC, OLED_ADDR)) {
    while (true); // stop if OLED not found
  }


  display.clearDisplay();
  display.display();
}


void drawSmiley() {
  display.clearDisplay();


  // Face outline
  display.drawCircle(64, 16, 14, SSD1306_WHITE);


  // Eyes
  display.fillCircle(58, 12, 2, SSD1306_WHITE);
  display.fillCircle(70, 12, 2, SSD1306_WHITE);


  // Smile
  display.drawLine(56, 20, 60, 22, SSD1306_WHITE);
  display.drawLine(60, 22, 68, 22, SSD1306_WHITE);
  display.drawLine(68, 22, 72, 20, SSD1306_WHITE);


  // Text
  display.setTextSize(1);
  display.setTextColor(SSD1306_WHITE);
  display.setCursor(2, 0);
  display.print("HYDRATED");


  display.display();
}


void drawSad() {
  display.clearDisplay();


  // Face outline
  display.drawCircle(64, 16, 14, SSD1306_WHITE);


  // Eyes
  display.fillCircle(58, 12, 2, SSD1306_WHITE);
  display.fillCircle(70, 12, 2, SSD1306_WHITE);


  // Sad mouth
  display.drawLine(56, 22, 60, 20, SSD1306_WHITE);
  display.drawLine(60, 20, 68, 20, SSD1306_WHITE);
  display.drawLine(68, 20, 72, 22, SSD1306_WHITE);


  // Text
  display.setTextSize(1);
  display.setTextColor(SSD1306_WHITE);
  display.setCursor(2, 0);
  display.print("DEHYDRATED");


  display.display();
}


void loop() {
  int sensor_analog = analogRead(sensor_pin);
  Serial.println(sensor_analog);


  if (sensor_analog < THRESHOLD) {
    drawSmiley();   // hydrated ðŸ™‚
  } else {
    drawSad();      // dehydrated â˜¹ï¸
  }


  delay(1000);
}
